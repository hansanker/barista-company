<div class="row wrap">
  <form class="col s12" [formGroup]="checklistForm" *ngIf="checklist" novalidate (ngSubmit)="submit(checklistForm.value)">
    <div class="row">
      <div class="col s12 input-field">
        <input type="text" id="customer" class="validate" formControlName="customer">
        <label for="customer">Customer</label>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s12">
        <input type="text" id="location" class="validate" formControlName="location">
        <label for="location">Location</label>
      </div>
    </div>
    <div class="days center" formArrayName="days">
      <h3>Days of work</h3>
      <div class="row content-table"
           *ngFor="let day of checklistForm.controls.days.controls; let i = index" [formGroupName]="i">
        <div class="col s12">
          <div class="row">
            <div class="col s12">
              <div class="row title">
                <div class="col s12">
                  <h5>
                    {{checklistForm.controls.days.controls[i].controls.date.value}}
                  </h5>
                </div>
              </div>
              <div class="row">
                <div class="col m4 s12">
                  <div class="row title">
                    <div class="col s12">Startup</div>
                  </div>
                  <div class="row title">
                    <div class="col s4">
                      Start
                    </div>
                    <div class="col s4">
                      End
                    </div>
                    <div class="col s4">
                      Total
                    </div>
                  </div>
                  <div class="row">
                    <div class="col s4">
                      <input type="text" [textMask]="{mask: mask}" placeholder="hh:mm" formControlName="startupStart">
                    </div>
                    <div class="col s4">
                      <input type="text" [textMask]="{mask: mask}" placeholder="hh:mm" formControlName="startupEnd">
                    </div>
                    <div class="col s4 total-text">
                      {{checklistForm.controls.days.controls[i].controls.startupTotal.value}}
                    </div>
                  </div>
                </div>
                <div class="col m4 s12">
                  <div class="row title">
                    <div class="col s12">Delivery</div>
                  </div>
                  <div class="row title">
                    <div class="col s4">
                      Start
                    </div>
                    <div class="col s4">
                      End
                    </div>
                    <div class="col s4">
                      Total
                    </div>
                  </div>
                  <div class="row">
                    <div class="col s4">
                      <input type="text" [textMask]="{mask: mask}" placeholder="hh:mm" formControlName="deliveryStart">
                    </div>
                    <div class="col s4">
                      <input type="text" [textMask]="{mask: mask}" placeholder="hh:mm" formControlName="deliveryEnd">
                    </div>
                    <div class="col s4 total-text">
                      {{checklistForm.controls.days.controls[i].controls.deliveryTotal.value}}
                    </div>
                  </div>
                </div>
                <div class="col m4 s12">
                  <div class="row title">
                    <div class="col s12">Cleaning</div>
                  </div>
                  <div class="row title">
                    <div class="col s4">
                      Start
                    </div>
                    <div class="col s4">
                      End
                    </div>
                    <div class="col s4">
                      Total
                    </div>
                  </div>
                  <div class="row">
                    <div class="col s4">
                      <input type="text" [textMask]="{mask: mask}" placeholder="hh:mm" formControlName="cleanupStart">
                    </div>
                    <div class="col s4">
                      <input type="text" [textMask]="{mask: mask}" placeholder="hh:mm" formControlName="cleanupEnd">
                    </div>
                    <div class="col s4 total-text">
                      {{checklistForm.controls.days.controls[i].controls.cleanupTotal.value}}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row total ">
            <div class="col s6 title">
              Total: {{checklistForm.controls.days.controls[i].controls.total.value}}
            </div>
            <div class="col s6">
              <a class="waves-effect waves-light btn red remove" (click)="removeDate(i)" *ngIf="i > 0">
                Delete<i class="material-icons">delete</i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row new-date">
      <div class="col m4 s12">
        <input materialize="pickadate" placeholder="Choose a date" #date
               [materializeParams]="[{format: getDateFormat()}]"
               type="text" />
      </div>
      <div class="col m4 s12">
        <a class="waves-effect waves-light waves-block btn" [ngClass]="{disabled: !date.value}"
           (click)="addDate(date.value)">Add new date</a>
      </div>
    </div>

    <div class="row" formArrayName="expenses">
      <div class="col s12">
        <h3 class="center">Expenses</h3>
        <div class="row"
             *ngFor="let expense of checklistForm.controls.expenses.controls; let i = index" [formGroupName]="i">
          <div class="col s12">
            <h5 class="center">{{expense.date}}</h5>
          </div>
          <div class="col m2 s6 input-field">
            <input type="text" id="type" name="type" placeholder="Type" formControlName="type">
          </div>
          <div class="col m2 s6 input-field">
            <input type="number" id="amount" name="type" placeholder="Amount" formControlName="amount">
            <label for="amount">{{expense.amount}}</label>
          </div>
          <div class="col m5 s12 input-field">
            <input type="text" id="remark" name="type" placeholder="Remark" formControlName="remark">
            <label for="remark">{{expense.remark}}</label>
          </div>
          <div class="col m3 s12">
            <a class="waves-effect waves-light waves-block btn red remove" (click)="removeExpense()">
              Delete<i class="material-icons">delete</i>
            </a>
          </div>
        </div>

        <div class="row new-date">
          <div class="col m4 s12">
            <input materialize="pickadate" placeholder="Choose a date" #date
                   [materializeParams]="[{format: getDateFormat()}]"
                   type="text" />
          </div>
          <div class="col m4 s12">
            <a class="waves-effect waves-light waves-block btn" [ngClass]="{disabled: !date.value}"
               (click)="addExpense(date.value)">Add new expense</a>
          </div>
        </div>
      </div>
    </div>

    <div class="row buttons">
      <div class="col s12 m6">
        <a class="waves-effect waves-light waves-block btn red lighten-1" (click)="save(checklistForm.value)">
          Save checklist
        </a>
      </div>
      <div class="col s12 m6">
        <a class="waves-effect waves-light waves-block btn" [ngClass]="{disabled: checklistForm.invalid}"
           (click)="submit(checklistForm.value)">Submit checklist</a>
      </div>
    </div>

  </form>

  <app-messages [checklistId]="checklistId"></app-messages>
</div>

